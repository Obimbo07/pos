<div class="container mx-auto py-8">
  <div class="max-w-4xl mx-auto bg-white rounded-lg overflow-hidden shadow-lg">
    <div class="px-8 py-6">
      <h1 class="text-3xl font-bold mb-6">Welcome, <%= @current_worker.name %>!</h1>
      
      <div class="mb-6">
        <ul class="flex border-b">
          <li class="-mb-px mr-1">
            <a href="#profile" class="bg-white inline-block py-2 px-4 text-blue-700 font-semibold hover:text-blue-800 border-b-2 border-blue-500">My Profile</a>
          </li>
          <li class="mr-1">
            <a href="#commissions" class="bg-white inline-block py-2 px-4 text-gray-500 font-semibold hover:text-blue-800">View Commissions</a>
          </li>
        </ul>
      </div>

      <div id="profile" class="tab-content">
        <div class="mb-6">
          <p class="text-lg text-gray-700 mb-2"><span class="font-bold">Name:</span> <%= @current_worker.name %></p>
          <p class="text-lg text-gray-700 mb-2"><span class="font-bold">Email:</span> <%= @current_worker.email %></p>
          <p class="text-lg text-gray-700 mb-2"><span class="font-bold">Phone:</span> <%= @current_worker.phone %></p>
        </div>
        <div class="mb-6">
          <h2 class="text-2xl font-semibold text-gray-900 mb-4">My Services:</h2>
          <ul class="list-disc pl-5 space-y-2 text-gray-700 text-sm">
            <% @services.each do |service| %>
              <li><span class="font-semibold"><%= service.name %>:</span> <%= number_to_currency(service.commission) %></li>
            <% end %>
          </ul>
        </div>
      </div>

      <div id="commissions" class="tab-content hidden">
        <div class="mb-6">
          <h2 class="text-2xl font-semibold text-gray-900 mb-4">Commission Earned:</h2>
          <div class="mb-6">
            <button id="request-cashout" class="inline-block bg-blue-700 text-white py-2 px-4 rounded-lg hover:bg-blue-800 transition duration-300">Request Cash Out</button>
          </div>
          <h2 class="text-2xl font-extrabold text-blue-600 mb-4"><%= number_to_currency(@total_commission) %></h2>
          <ul class="list-disc pl-5 space-y-2 text-gray-700 text-lg">
            <% @worker_commissions.each do |commission| %>
              <li><%= number_to_currency(commission.commission) %> earned on <%= commission.timestamp.strftime("%B %d, %Y") %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>


<div id="cashout-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg max-w-md w-full p-6">
    <h5 class="text-xl font-bold mb-4">Enter the amount you wish to cash out</h5>
    <%= form_with url: home_path, method: :post, local: true do |f| %>
      <div class="mb-4">
        <%= f.label :amount, "Amount", class: "block text-gray-700 font-bold mb-2" %>
        <%= f.text_field :amount, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
      </div>
      <div class="flex justify-end">
        <button type="button" id="cancel-button" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mr-2">Cancel</button>
        <%= f.submit "Confirm", class: "bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded", id: "confirm-pay" %>
      </div>
    <% end %>
  </div>
</div>

<script>
  document.querySelectorAll('.tab-content').forEach((content) => content.classList.add('hidden'));
  document.querySelector('#profile').classList.remove('hidden');

  document.querySelectorAll('a[href^="#"]').forEach((tab) => {
    tab.addEventListener('click', (event) => {
      event.preventDefault();
      document.querySelectorAll('.tab-content').forEach((content) => content.classList.add('hidden'));
      document.querySelector(tab.getAttribute('href')).classList.remove('hidden');
      document.querySelectorAll('a').forEach((link) => link.classList.remove('border-blue-500', 'text-blue-700'));
      tab.classList.add('border-blue-500', 'text-blue-700');
    });
  });

  document.getElementById('request-cashout').addEventListener('click', () => {
    document.getElementById('cashout-modal').classList.remove('hidden');
  });

  document.getElementById('cancel-button').addEventListener('click', () => {
    document.getElementById('cashout-modal').classList.add('hidden');
  });
</script>
